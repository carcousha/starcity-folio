# ๐ ุชูุฑูุฑ ุดุงูู - ูุดุฑูุน StarCity Folio ุงูุนูุงุฑู

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุดุฑูุน

### ุชุนุฑูู ุงููุดุฑูุน
**StarCity Folio** ูู ูุธุงู ุฅุฏุงุฑุฉ ุนูุงุฑูุฉ ูุชูุงูู ููุชุทูุฑ ูุตูู ุฎุตูุตุงู ูุดุฑูุงุช ุงูุนูุงุฑุงุช ูู ููุทูุฉ ุงูุดุฑู ุงูุฃูุณุทุ ูุน ุงูุชุฑููุฒ ุนูู ุงูุณูู ุงูุฅูุงุฑุงุชู ูุงูุนุฑุจู. ุงููุธุงู ูุฌูุน ุจูู ุฅุฏุงุฑุฉ ุงูุนูุงูุงุช ูุน ุงูุนููุงุก (CRM)ุ ุงููุญุงุณุจุฉุ ุฅุฏุงุฑุฉ ุงูุนูุงุฑุงุชุ ูุงูุฐูุงุก ุงูุงุตุทูุงุนู ูู ููุตุฉ ูุงุญุฏุฉ.

### ุงููุฏู ุงูุฃุณุงุณู
ุชุญููู ุงูุนูููุงุช ุงูุนูุงุฑูุฉ ุงูุชูููุฏูุฉ ุฅูู ูุธุงู ุฑููู ุฐูู ููุชุทูุฑุ ูููุฑ:
- ุฅุฏุงุฑุฉ ุดุงููุฉ ููุนููุงุก ูุงูุนูุงุฑุงุช
- ูุธุงู ูุญุงุณุจุฉ ูุชูุงูู
- ุฐูุงุก ุงุตุทูุงุนู ููุชุญููู ูุงูุชูุจุค
- ุชูุงูู ูุน WhatsApp ููุชุณููู
- ุชูุงุฑูุฑ ูุชุญูููุงุช ูุชูุฏูุฉ

---

## ๐๏ธ ุงูุจููุฉ ุงูุชูููุฉ ุงูุฃุณุงุณูุฉ

### ุงูุชูููุงุช ุงููุณุชุฎุฏูุฉ

#### Frontend Framework
```typescript
// React 18 ูุน TypeScript
- React 18.2.0 (ุฃุญุฏุซ ุฅุตุฏุงุฑ ูุณุชูุฑ)
- TypeScript 5.0+ (ููุฃูุงู ูุงูุฌูุฏุฉ)
- Vite 4.0+ (ุฃุฏุงุฉ ุจูุงุก ุณุฑูุนุฉ)
- Tailwind CSS (ุชุตููู ูุชุฌุงูุจ)
- Shadcn/ui (ููููุงุช UI ูุชูุฏูุฉ)
```

#### Backend & Database
```typescript
// Supabase ูู Backend-as-a-Service
- Supabase (PostgreSQL + Real-time)
- Row Level Security (RLS)
- Edge Functions
- Storage Buckets
- Authentication System
```

#### State Management & Data Fetching
```typescript
// ุฅุฏุงุฑุฉ ุงูุญุงูุฉ ูุงูุจูุงูุงุช
- React Query (TanStack Query)
- React Context API
- Local Storage Management
- Real-time Subscriptions
```

#### Development Tools
```typescript
// ุฃุฏูุงุช ุงูุชุทููุฑ
- ESLint (ุฌูุฏุฉ ุงูููุฏ)
- Prettier (ุชูุณูู ุงูููุฏ)
- Husky (Git Hooks)
- TypeScript Strict Mode
```

---

## ๐ ูููู ุงููุดุฑูุน

### ุชูุธูู ุงููููุงุช
```
starcity-folio/
โโโ ๐ src/
โ   โโโ ๐ components/          # ุงูููููุงุช ุงููุงุจูุฉ ูุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู
โ   โ   โโโ ๐ ui/             # ููููุงุช UI ุงูุฃุณุงุณูุฉ
โ   โ   โโโ ๐ crm/            # ููููุงุช ุฅุฏุงุฑุฉ ุงูุนูุงูุงุช
โ   โ   โโโ ๐ accounting/     # ููููุงุช ุงููุญุงุณุจุฉ
โ   โ   โโโ ๐ rental/         # ููููุงุช ุงูุฅูุฌุงุฑุงุช
โ   โ   โโโ ๐ ai/             # ููููุงุช ุงูุฐูุงุก ุงูุงุตุทูุงุนู
โ   โ   โโโ ๐ whatsapp/       # ููููุงุช WhatsApp
โ   โ   โโโ ๐ security/       # ููููุงุช ุงูุฃูุงู
โ   โโโ ๐ pages/              # ุตูุญุงุช ุงูุชุทุจูู
โ   โ   โโโ ๐ crm/            # ุตูุญุงุช ุฅุฏุงุฑุฉ ุงูุนูุงูุงุช
โ   โ   โโโ ๐ accounting/     # ุตูุญุงุช ุงููุญุงุณุจุฉ
โ   โ   โโโ ๐ rental/         # ุตูุญุงุช ุงูุฅูุฌุงุฑุงุช
โ   โ   โโโ ๐ employee/       # ุตูุญุงุช ุงูููุธููู
โ   โ   โโโ ๐ reports/        # ุตูุญุงุช ุงูุชูุงุฑูุฑ
โ   โ   โโโ ๐ whatsapp/       # ุตูุญุงุช WhatsApp
โ   โโโ ๐ hooks/              # Custom React Hooks
โ   โโโ ๐ services/           # ุฎุฏูุงุช API ูุงูููุทู ุงูุชุฌุงุฑู
โ   โโโ ๐ types/              # ุชุนุฑููุงุช TypeScript
โ   โโโ ๐ lib/                # ููุชุจุงุช ูุณุงุนุฏุฉ
โ   โโโ ๐ config/             # ูููุงุช ุงูุชูููู
โ   โโโ ๐ integrations/       # ุชูุงููุงุช ุฎุงุฑุฌูุฉ
โโโ ๐ supabase/               # ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงููุธุงุฆู
โ   โโโ ๐ migrations/         # ูููุงุช ุงููุฌุฑุฉ
โ   โโโ ๐ functions/          # Edge Functions
โ   โโโ ๐ config.toml         # ุชูููู Supabase
โโโ ๐ public/                 # ุงููููุงุช ุงูุนุงูุฉ
โโโ ๐ docs/                   # ุงููุซุงุฆู
```

---

## ๐ ูุธุงู ุงููุตุงุฏูุฉ ูุงูุฃูุงู

### ูุนูุงุฑูุฉ ุงูุฃูุงู ูุชุนุฏุฏุฉ ุงูุทุจูุงุช

#### 1. AuthGuard (ุงูุญูุงูุฉ ุงูุฃุณุงุณูุฉ)
```typescript
// src/components/AuthGuard.tsx
export const AuthGuard = ({ children }: AuthGuardProps) => {
  const { user, session, profile, loading } = useAuth();
  
  // ูุญุต ููุฑู ุนูุฏ ุชุบููุฑ ุงููุณุงุฑ
  useEffect(() => {
    if (!loading && !isLoginPage) {
      if (!session || !user || !profile) {
        window.location.href = '/';
        return;
      }
    }
  }, [loading, session, user, profile, location.pathname]);
  
  // ูุญุต ุฏูุฑู ูุดุฏุฏ ูู 15 ุซุงููุฉ
  useEffect(() => {
    const checkAuthStrict = () => {
      if (!session || !user || !profile) {
        window.location.href = '/';
      }
    };
    const interval = setInterval(checkAuthStrict, 15000);
    return () => clearInterval(interval);
  }, [session, user, profile]);
}
```

#### 2. StrictAuthProtector (ุงูุญูุงูุฉ ุงููุทููุฉ)
```typescript
// src/components/StrictAuthProtector.tsx
export const StrictAuthProtector = ({ children }) => {
  // ุญูุงูุฉ ููุฑูุฉ ููุทููุฉ ุนูุฏ ุชุญููู ุฃู ุตูุญุฉ
  useEffect(() => {
    if (currentPath !== '/') {
      if (!loading && (!session || !user)) {
        localStorage.clear();
        sessionStorage.clear();
        window.location.replace('/');
        return;
      }
    }
  }, [currentPath, loading, session, user, profile]);
}
```

#### 3. RouteGuard (ุญูุงูุฉ ุงููุณุงุฑุงุช)
```typescript
// src/components/RouteGuard.tsx
export const RouteGuard = ({ children }: RouteGuardProps) => {
  const protectedPaths = [
    '/dashboard', '/admin-dashboard', '/crm', '/accounting', 
    '/rental', '/reports', '/employee', '/tasks', '/my-', '/settings'
  ];
  
  // ูุญุต ููุฑู ุนูุฏ ุชุญููู ุฃู ูุณุงุฑ
  useEffect(() => {
    const isProtectedPath = protectedPaths.some(path => 
      currentPath.startsWith(path)) || currentPath !== '/';
    
    if (isProtectedPath && !loading) {
      if (!session || !user || !profile) {
        window.location.href = '/';
        return;
      }
    }
  }, [location.pathname, loading, session, user, profile]);
}
```

#### 4. ProtectedRoute (ุญูุงูุฉ ุงูููููุงุช)
```typescript
// src/components/ProtectedRoute.tsx
export const ProtectedRoute = ({ children, requiredPermission }) => {
  const { user, profile, loading, session } = useAuth();
  const { checkPermission } = useRoleAccess();
  
  // ููุน ุนุฑุถ ุฃู ูุญุชูู ุฅุฐุง ูู ููู ููุงู session ุตุงูุญ
  useEffect(() => {
    if (!loading && (!session || !user)) {
      window.location.href = '/';
    }
  }, [loading, session, user]);
  
  // ุชุญูู ูู ุงูุตูุงุญูุฉ ุจุนุฏ ุชุญููู ูู ุดูุก
  if (!checkPermission(requiredPermission)) {
    window.location.href = '/';
    return null;
  }
  
  return <>{children}</>;
}
```

### ูุธุงู ุฅุฏุงุฑุฉ ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช

#### ุชุนุฑูู ุงูุฃุฏูุงุฑ
```typescript
// src/hooks/useRoleAccess.tsx
type UserRole = 'admin' | 'accountant' | 'employee';

const rolePermissions: Record<UserRole, PermissionKey[]> = {
  admin: [
    'canManageStaff', 'canViewFinancials', 'canManageExpenses',
    'canManageRevenues', 'canManageCommissions', 'canManageDebts',
    'canViewAllVehicles', 'canViewAllStaff', 'canViewTreasury',
    'canViewActivityLogs', 'canViewAllReports', 'canManageDeals',
    'canViewAllDeals', 'crmAccess'
  ],
  accountant: [
    'canViewFinancials', 'canManageExpenses', 'canManageRevenues',
    'canManageCommissions', 'canManageDebts', 'canViewTreasury',
    'canViewActivityLogs', 'canViewAllReports', 'crmAccess'
  ],
  employee: [
    'crmAccess', 'canViewActivityLogs'
  ]
};
```

---

## ๐จ ูุงุฌูุฉ ุงููุณุชุฎุฏู ูุงูุชุตููู

### ูุธุงู ุงูุชุตููู

#### Tailwind CSS + Shadcn/ui
```typescript
// ุชูููู Tailwind CSS
// tailwind.config.ts
export default {
  content: ["./src/**/*.{js,jsx,ts,tsx}"],
  theme: {
    extend: {
      colors: {
        primary: {
          50: '#eff6ff',
          500: '#3b82f6',
          600: '#2563eb',
          700: '#1d4ed8',
        },
        // ุฃููุงู ูุฎุตุตุฉ ูููุธุงู ุงูุนูุงุฑู
      },
      fontFamily: {
        'arabic': ['Cairo', 'sans-serif'],
      },
      direction: {
        'rtl': 'rtl',
        'ltr': 'ltr',
      }
    }
  },
  plugins: [require("tailwindcss-animate")]
}
```

#### ุงูููููุงุช ุงูุฃุณุงุณูุฉ
```typescript
// ููููุงุช UI ุงูุฃุณุงุณูุฉ ุงููุณุชุฎุฏูุฉ
- Card, CardContent, CardHeader, CardTitle
- Button (ูุน variants ูุชุนุฏุฏุฉ)
- Input, Textarea, Select
- Table, TableBody, TableCell, TableHead, TableHeader, TableRow
- Dialog, DialogContent, DialogHeader, DialogTitle
- Tabs, TabsContent, TabsList, TabsTrigger
- Badge, Alert, Progress
- Avatar, DropdownMenu
- Form components ูุน React Hook Form
```

### ุงูุชุตููู ุงููุชุฌุงูุจ
```typescript
// ุงุณุชุฑุงุชูุฌูุฉ ุงูุชุตููู ุงููุชุฌุงูุจ
- Mobile First Approach
- Breakpoints: sm (640px), md (768px), lg (1024px), xl (1280px)
- RTL Support ููุบุฉ ุงูุนุฑุจูุฉ
- Dark/Light Mode Support
- Accessibility (ARIA labels, keyboard navigation)
```

---

## ๐ ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช ูุงูุญุงูุฉ

### React Query (TanStack Query)
```typescript
// ุชูููู React Query
const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      retry: 1,
      refetchOnWindowFocus: false,
      staleTime: 5 * 60 * 1000, // 5 ุฏูุงุฆู
      cacheTime: 10 * 60 * 1000, // 10 ุฏูุงุฆู
    },
  },
});

// ูุซุงู ุนูู ุงุณุชุฎุฏุงู React Query
const { data: clients, isLoading, error } = useQuery({
  queryKey: ['crm-clients'],
  queryFn: async () => {
    const { data, error } = await supabase
      .from('clients')
      .select('*')
      .order('created_at', { ascending: false });
    
    if (error) throw error;
    return data;
  },
  enabled: !!user, // ุชุดุบูู ุงูุงุณุชุนูุงู ููุท ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุณุฌู
});
```

### ุฅุฏุงุฑุฉ ุงูุญุงูุฉ ุงููุญููุฉ
```typescript
// Custom Hooks ูุฅุฏุงุฑุฉ ุงูุญุงูุฉ
// src/hooks/useAuth.tsx - ุฅุฏุงุฑุฉ ุงููุตุงุฏูุฉ
// src/hooks/useRoleAccess.tsx - ุฅุฏุงุฑุฉ ุงูุตูุงุญูุงุช
// src/hooks/useGlobalSelectedBrokers.tsx - ุฅุฏุงุฑุฉ ุงููุณุทุงุก ุงููุญุฏุฏูู
// src/hooks/useBulkSelection.tsx - ุฅุฏุงุฑุฉ ุงูุงุฎุชูุงุฑ ุงููุชุนุฏุฏ
// src/hooks/useToast.tsx - ุฅุฏุงุฑุฉ ุงูุฅุดุนุงุฑุงุช
```

---

## ๐ ุงูุชูุฌูู ูุงูุชููู

### React Router DOM
```typescript
// ุชูููู ุงูุชูุฌูู
// src/App.tsx
<BrowserRouter>
  <Routes>
    {/* ูุณุงุฑุงุช ูุญููุฉ ูุน lazy loading */}
    <Route path="/admin-dashboard" element={
      <ProtectedRoute requiredPermission="canManageStaff">
        <Suspense fallback={<LoadingSpinner />}>
          <DashboardHome />
        </Suspense>
      </ProtectedRoute>
    } />
    
    {/* ูุณุงุฑุงุช CRM */}
    <Route path="/crm" element={
      <ProtectedRoute requiredPermission="crmAccess">
        <Suspense fallback={<LoadingSpinner />}>
          <CRMIndex />
        </Suspense>
      </ProtectedRoute>
    } />
    
    {/* ูุณุงุฑุงุช ุงููุญุงุณุจุฉ */}
    <Route path="/accounting" element={
      <ProtectedRoute requiredPermission="canViewFinancials">
        <Suspense fallback={<LoadingSpinner />}>
          <AccountingIndex />
        </Suspense>
      </ProtectedRoute>
    } />
  </Routes>
</BrowserRouter>
```

### Lazy Loading ููููููุงุช
```typescript
// ุชุญููู ูุณูู ููููููุงุช ูุชุญุณูู ุงูุฃุฏุงุก
const Auth = lazy(() => import("./pages/Auth"));
const CRMIndex = lazy(() => import("./pages/crm/index"));
const Clients = lazy(() => import("./pages/crm/Clients"));
const Leads = lazy(() => import("./pages/crm/Leads"));
const AccountingIndex = lazy(() => import("./pages/accounting/index"));
const WhatsAppModule = lazy(() => import("./pages/whatsapp/index"));
const AIIntelligenceHub = lazy(() => import("./components/ai"));
```

---

## ๐ฏ ุงููุญุฏุงุช ุงูุฑุฆูุณูุฉ ูููุธุงู

### 1. ูุญุฏุฉ ุฅุฏุงุฑุฉ ุงูุนูุงูุงุช (CRM Module)
- ุฅุฏุงุฑุฉ ุงูุนููุงุก ูุงูููุฏุงุช
- ุฅุฏุงุฑุฉ ุงูุนูุงุฑุงุช ูุงูููุงู
- ุฅุฏุงุฑุฉ ุงูููุงู ูุงูุญููุงุช ุงูุชุณููููุฉ
- ุชุชุจุน ุงูุตููุงุช ูุงูุฃูุดุทุฉ

### 2. ูุญุฏุฉ ุงููุญุงุณุจุฉ (Accounting Module)
- ุฅุฏุงุฑุฉ ุงููุตุฑููุงุช ูุงูุฅูุฑุงุฏุงุช
- ุฅุฏุงุฑุฉ ุงูุนูููุงุช ูุงูุฏููู
- ุฅุฏุงุฑุฉ ุงููุฑูุจุงุช ููุตุฑููุงุชูุง
- ุฅุฏุงุฑุฉ ุงูุฎุฒููุฉ ูุงูููุธููู
- ุงูุณุฌู ุงููููู ูุงูุฏูุงุชุฑ

### 3. ูุญุฏุฉ ุงูุฅูุฌุงุฑุงุช (Rental Module)
- ุฅุฏุงุฑุฉ ุงูุนูุงุฑุงุช ุงููุคุฌุฑุฉ
- ุฅุฏุงุฑุฉ ุงููุณุชุฃุฌุฑูู ูุงูุนููุฏ
- ุฅุฏุงุฑุฉ ุงูุฃูุณุงุท ูุงูุฎุฏูุงุช ุงูุญููููุฉ
- ุชูููุฏ ุงูุนููุฏ ุชููุงุฆูุงู

### 4. ูุญุฏุฉ ุงูุฐูุงุก ุงูุงุตุทูุงุนู (AI Module)
- ุชุญููู ุงูุนููุงุก ูุงูุนูุงุฑุงุช
- ุงูุชูุตูุงุช ุงูุฐููุฉ
- ุงูุชูุจุคุงุช ุงูุณูููุฉ
- ุชุญููู ุงูุฃุฏุงุก ูุงูุชุญูููุงุช

### 5. ูุญุฏุฉ WhatsApp (WhatsApp Module)
- ุฅุฑุณุงู ุฑุณุงุฆู ุฌูุงุนูุฉ
- ุญููุงุช ุชุณููููุฉ ุฐููุฉ
- ุฅุฏุงุฑุฉ ุฌูุงุช ุงูุงุชุตุงู
- ุชุชุจุน ุงูุฑุณุงุฆู ูุงูุฅุญุตุงุฆูุงุช

### 6. ูุญุฏุฉ ุงูุชูุงุฑูุฑ (Reports Module)
- ุชูุงุฑูุฑ ุงูููุธููู ูุงูุฃุฏุงุก
- ุชูุงุฑูุฑ ุงููุฑูุจุงุช
- ุชูุงุฑูุฑ ุงูุนูููุงุช ูุงูุฏููู
- ุชูุงุฑูุฑ ุงููุตุฑููุงุช ูุงูุฅูุฑุงุฏุงุช
- ุชูุงุฑูุฑ ุงูุฎุฒููุฉ

### 7. ูุญุฏุฉ ุงูููุธููู (Employee Module)
- ููุญุฉ ุชุญูู ุงูููุธููู
- ุฅุฏุงุฑุฉ ุงูุนูููุงุช ุงูุดุฎุตูุฉ
- ุฅุฏุงุฑุฉ ุงูุฏููู ุงูุดุฎุตูุฉ
- ุฅุฏุงุฑุฉ ุงููุฑูุจุงุช ุงูุดุฎุตูุฉ
- ุฅุฏุงุฑุฉ ุงูุทูุจุงุช ูุงูุดูุงูู

---

*ูุชุจุน ูู ุงูุฌุฒุก ุงูุชุงูู: ุงููุดุงูู ุงูุชู ุชู ุญููุง ูุงูุชุทููุฑุงุช ุงูููุฌุฒุฉ...*
